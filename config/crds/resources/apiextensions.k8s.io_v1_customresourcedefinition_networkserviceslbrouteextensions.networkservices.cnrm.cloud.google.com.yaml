# Generated by dev/tasks/generate-crds.  DO NOT EDIT.

apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    cnrm.cloud.google.com/version: 0.0.0-dev
  creationTimestamp: null
  labels:
    cnrm.cloud.google.com/managed-by-kcc: "true"
    cnrm.cloud.google.com/system: "true"
  name: networkserviceslbrouteextensions.networkservices.cnrm.cloud.google.com
spec:
  group: networkservices.cnrm.cloud.google.com
  names:
    categories:
    - gcp
    kind: NetworkServicesLBRouteExtension
    listKind: NetworkServicesLBRouteExtensionList
    plural: networkserviceslbrouteextensions
    shortNames:
    - gcpnetworkserviceslbrouteextension
    - gcpnetworkserviceslbrouteextensions
    singular: networkserviceslbrouteextension
  preserveUnknownFields: false
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    - description: When 'True', the most recent reconcile of the resource succeeded
      jsonPath: .status.conditions[?(@.type=='Ready')].status
      name: Ready
      type: string
    - description: The reason for the value in 'Ready'
      jsonPath: .status.conditions[?(@.type=='Ready')].reason
      name: Status
      type: string
    - description: The last transition time for the value in 'Status'
      jsonPath: .status.conditions[?(@.type=='Ready')].lastTransitionTime
      name: Status Age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: NetworkServicesLBRouteExtension is the Schema for the NetworkServicesLBRouteExtension
          API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: NetworkServicesLBRouteExtensionSpec defines the desired state
              of NetworkServicesLBRouteExtension
            properties:
              description:
                description: Optional. A human-readable description of the resource.
                type: string
              extensionChains:
                description: Required. A set of ordered extension chains that contain
                  the match conditions and extensions to execute. Match conditions
                  for each extension chain are evaluated in sequence for a given request.
                  The first extension chain that has a condition that matches the
                  request is executed. Any subsequent extension chains do not execute.
                  Limited to 5 extension chains per resource.
                items:
                  properties:
                    extensions:
                      description: Required. A set of extensions to execute for the
                        matching request. At least one extension is required. Up to
                        3 extensions can be defined for each extension chain for `LBTrafficExtension`
                        resource. `LBRouteExtension` and `LBEdgeExtension` chains
                        are limited to 1 extension per extension chain.
                      items:
                        properties:
                          authority:
                            description: |-
                              Optional. The `:authority` header in the gRPC request sent from Envoy
                              to the extension service.
                              Required for Callout extensions.

                              This field is not supported for plugin extensions. Setting it results in
                              a validation error.
                            type: string
                          backendServiceRef:
                            description: |-
                              Optional. The reference to the service that runs the extension.

                              To configure a callout extension, `service` must be a fully-qualified reference
                              to a [backend service](https://cloud.google.com/compute/docs/reference/rest/v1/backendServices)
                              in the format:
                              `https://www.googleapis.com/compute/v1/projects/{project}/regions/{region}/backendServices/{backendService}`
                              or
                              `https://www.googleapis.com/compute/v1/projects/{project}/global/backendServices/{backendService}`.
                            oneOf:
                            - not:
                                required:
                                - external
                              required:
                              - name
                            - not:
                                anyOf:
                                - required:
                                  - name
                                - required:
                                  - namespace
                              required:
                              - external
                            properties:
                              external:
                                description: The value of an externally managed ComputeBackendService
                                  resource.
                                type: string
                              name:
                                description: The name of a ComputeBackendService resource.
                                type: string
                              namespace:
                                description: The namespace of a ComputeBackendService
                                  resource.
                                type: string
                            type: object
                          failOpen:
                            description: |-
                              Optional. Determines how the proxy behaves if the call to the extension
                              fails or times out.

                              When set to `TRUE`, request or response processing continues without
                              error. Any subsequent extensions in the extension chain are also
                              executed. When set to `FALSE` or the default setting of `FALSE` is used,
                              one of the following happens:

                              * If response headers have not been delivered to the downstream client,
                              a generic 500 error is returned to the client. The error response can be
                              tailored by configuring a custom error response in the load balancer.

                              * If response headers have been delivered, then the HTTP stream to the
                              downstream client is reset.
                            type: boolean
                          forwardHeaders:
                            description: Optional. List of the HTTP headers to forward
                              to the extension (from the client or backend). If omitted,
                              all headers are sent. Each element is a string indicating
                              the header name.
                            items:
                              type: string
                            type: array
                          metadata:
                            description: |-
                              Optional. The metadata provided here is included as part of the
                              `metadata_context` (of type `google.protobuf.Struct`) in the
                              `ProcessingRequest` message sent to the extension server.

                              The metadata is available under the namespace
                              `com.google.<extension_type>.<resource_name>.<extension_chain_name>.<extension_name>`.
                              For example:
                              `com.google.lb_traffic_extension.lbtrafficextension1.chain1.ext1`.

                              The following variables are supported in the metadata:

                              `{forwarding_rule_id}` - substituted with the forwarding rule's fully
                              qualified resource name.

                              This field must not be set for plugin extensions. Setting it results in
                              a validation error.

                              You can set metadata at either the resource level or the extension level.
                              The extension level metadata is recommended because you can pass a
                              different set of metadata through each extension to the backend.

                              This field is subject to following limitations:

                              * The total size of the metadata must be less than 1KiB.
                              * The total number of keys in the metadata must be less than 16.
                              * The length of each key must be less than 64 characters.
                              * The length of each value must be less than 1024 characters.
                              * All values must be strings.
                            x-kubernetes-preserve-unknown-fields: true
                          name:
                            description: Required. The name for this extension. The
                              name is logged as part of the HTTP request logs. The
                              name must conform with RFC-1034, is restricted to lower-cased
                              letters, numbers and hyphens, and can have a maximum
                              length of 63 characters. Additionally, the first character
                              must be a letter and the last a letter or a number.
                            type: string
                          supportedEvents:
                            description: |-
                              Optional. A set of events during request or response processing for which
                              this extension is called.

                              For the `LBTrafficExtension` resource, this field is required.

                              For the `LBRouteExtension` resource, this field is optional. If
                              unspecified, `REQUEST_HEADERS` event is assumed as supported.

                              For the `LBEdgeExtension` resource, this field is required and must only
                              contain `REQUEST_HEADERS` event.
                            items:
                              type: string
                            type: array
                          timeout:
                            description: |-
                              Optional. Specifies the timeout for each individual message on the
                              stream. The timeout must be between `10`-`10000` milliseconds. Required
                              for callout extensions.

                              This field is not supported for plugin extensions. Setting it results in
                              a validation error.
                            type: string
                          wasmPluginRef:
                            description: |-
                              Optional. The reference to the WasmPlugin resource.

                              To configure a plugin extension, `service` must be a reference to a
                              [`WasmPlugin` resource](https://cloud.google.com/service-extensions/docs/reference/rest/v1beta1/projects.locations.wasmPlugins)
                              in the format:
                              `projects/{project}/locations/{location}/wasmPlugins/{plugin}`
                              or
                              `//networkservices.googleapis.com/projects/{project}/locations/{location}/wasmPlugins/{wasmPlugin}`.

                              Plugin extensions are currently supported for the `LBTrafficExtension`, the
                              `LBRouteExtension`, and the `LBEdgeExtension` resources.

                              Note: Only the `external` subfield is supported as the
                              `NetworkServicesWasmPlugin` resource is not yet supported in Config Connector.
                            oneOf:
                            - not:
                                required:
                                - external
                              required:
                              - name
                            - not:
                                anyOf:
                                - required:
                                  - name
                                - required:
                                  - namespace
                              required:
                              - external
                            properties:
                              external:
                                description: 'The name of the wasmplugin. Allowed
                                  value: The Google Cloud resource name of a `NetworkServicesWasmPlugin`
                                  resource (format: `projects/{{project}}/locations/{{location}}/wasmPlugins/{{name}}`).'
                                type: string
                              name:
                                description: 'Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names'
                                type: string
                              namespace:
                                description: 'Namespace of the referent. More info:
                                  https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/'
                                type: string
                            type: object
                        required:
                        - name
                        type: object
                        x-kubernetes-validations:
                        - message: either backendServiceRef or wasmPluginRef must
                            be set
                          rule: has(self.backendServiceRef) != has(self.wasmPluginRef)
                      type: array
                    matchCondition:
                      description: Required. Conditions under which this chain is
                        invoked for a request.
                      properties:
                        celExpression:
                          description: |-
                            Required. A Common Expression Language (CEL) expression that is used to
                            match requests for which the extension chain is executed.

                            For more information, see [CEL matcher language
                            reference](https://cloud.google.com/service-extensions/docs/cel-matcher-language-reference).
                          type: string
                      required:
                      - celExpression
                      type: object
                    name:
                      description: Required. The name for this extension chain. The
                        name is logged as part of the HTTP request logs. The name
                        must conform with RFC-1034, is restricted to lower-cased letters,
                        numbers and hyphens, and can have a maximum length of 63 characters.
                        Additionally, the first character must be a letter and the
                        last a letter or a number.
                      type: string
                  required:
                  - extensions
                  - matchCondition
                  - name
                  type: object
                type: array
              forwardingRuleRefs:
                description: Required. A list of references to the forwarding rules
                  to which this service extension is attached. At least one forwarding
                  rule is required. Only one LBRouteExtension resource can be associated
                  with a forwarding rule.
                items:
                  description: ForwardingRuleRef defines the resource reference to
                    ComputeForwardingRule, which "External" field holds the GCP identifier
                    for the KRM object.
                  oneOf:
                  - not:
                      required:
                      - external
                    required:
                    - name
                  - not:
                      anyOf:
                      - required:
                        - name
                      - required:
                        - namespace
                    required:
                    - external
                  properties:
                    external:
                      description: A reference to an externally managed ComputeForwardingRule
                        resource. Should be in the format "projects/{{projectID}}/global/forwardingRules/{{forwardingRuleID}}"
                        or "projects/{{projectID}}/regions/{{region}}/forwardingRules/{{forwardingRuleID}}".
                      type: string
                    name:
                      description: The name of a ComputeForwardingRule resource.
                      type: string
                    namespace:
                      description: The namespace of a ComputeForwardingRule resource.
                      type: string
                  type: object
                type: array
              loadBalancingScheme:
                description: 'Required. All backend services and forwarding rules
                  referenced by this extension must share the same load balancing
                  scheme. Supported values: INTERNAL_MANAGED, EXTERNAL_MANAGED.'
                type: string
              location:
                type: string
                x-kubernetes-validations:
                - message: Location is immutable.
                  rule: self == oldSelf
              metadata:
                description: Optional. The metadata provided here is included as part
                  of the metadata_context (of type google.protobuf.Struct) in the
                  ProcessingRequest message sent to the extension server.
                x-kubernetes-preserve-unknown-fields: true
              projectRef:
                description: The Project that this resource belongs to.
                oneOf:
                - not:
                    required:
                    - external
                  required:
                  - name
                - not:
                    anyOf:
                    - required:
                      - name
                    - required:
                      - namespace
                  required:
                  - external
                properties:
                  external:
                    description: The `projectID` field of a project, when not managed
                      by Config Connector.
                    type: string
                  kind:
                    description: The kind of the Project resource; optional but must
                      be `Project` if provided.
                    type: string
                  name:
                    description: The `name` field of a `Project` resource.
                    type: string
                  namespace:
                    description: The `namespace` field of a `Project` resource.
                    type: string
                type: object
              resourceID:
                description: The NetworkServicesLBRouteExtension name. If not given,
                  the metadata.name will be used.
                type: string
            required:
            - extensionChains
            - forwardingRuleRefs
            - loadBalancingScheme
            - location
            - projectRef
            type: object
          status:
            description: NetworkServicesLBRouteExtensionStatus defines the config
              connector machine state of NetworkServicesLBRouteExtension
            properties:
              conditions:
                description: Conditions represent the latest available observations
                  of the object's current state.
                items:
                  properties:
                    lastTransitionTime:
                      description: Last time the condition transitioned from one status
                        to another.
                      type: string
                    message:
                      description: Human-readable message indicating details about
                        last transition.
                      type: string
                    reason:
                      description: Unique, one-word, CamelCase reason for the condition's
                        last transition.
                      type: string
                    status:
                      description: Status is the status of the condition. Can be True,
                        False, Unknown.
                      type: string
                    type:
                      description: Type is the type of the condition.
                      type: string
                  type: object
                type: array
              externalRef:
                description: A unique specifier for the NetworkServicesLBRouteExtension
                  resource in GCP.
                type: string
              observedGeneration:
                description: ObservedGeneration is the generation of the resource
                  that was most recently observed by the Config Connector controller.
                  If this is equal to metadata.generation, then that means that the
                  current reported status reflects the most recent desired state of
                  the resource.
                format: int64
                type: integer
              observedState:
                description: ObservedState is the state of the resource as most recently
                  observed in GCP.
                properties:
                  createTime:
                    description: Output only. The timestamp when the resource was
                      created.
                    type: string
                  updateTime:
                    description: Output only. The timestamp when the resource was
                      updated.
                    type: string
                type: object
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
